import std/strformat, helpers

proc get_stub*(shellcode: seq[byte]): string =
    var encoded: seq[byte] = @[]
    for b in shellcode:
        encoded.add(byte(uint8(b) + 13))
    return get_shellcode_str(encoded) & fmt"""

# decrypt encoded shellcode
var shellcode: array[{len(encoded)}, byte] 
for i, b in encoded_shellcode:
    shellcode[i] = byte(uint8(b) - 13)
    """